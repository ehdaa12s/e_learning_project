<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Student Dashboard</title>
<link rel="stylesheet" href="../css/style.css">
<link rel="stylesheet" href="../css/student.css">
</head>
<body>

<h1>Welcome, <span id="studentName">Student</span>!</h1>

<h2>My Courses</h2>
<div id="myCoursesContainer" class="courses-grid"></div>

<script type="module">
import { DB } from "../js/db.js";

const currentUser = JSON.parse(localStorage.getItem('currentUser') || '{}');
if(!currentUser.email || currentUser.type !== 'student'){
    window.location.href = '../login.html';
}

document.getElementById('studentName').textContent = currentUser.name || 'Student';

function loadMyCourses(){
    const enrollments = DB.getEnrollments().filter(e => e.studentId === currentUser.id);
    const courses = DB.getCourses();
    const container = document.getElementById('myCoursesContainer');

    if(enrollments.length === 0){
        container.innerHTML = '<p class="no-data">You have not enrolled in any courses yet.</p>';
        return;
    }

    container.innerHTML = enrollments.map(e => {
        const course = courses.find(c => c.id === e.courseId);
        if(!course) return '';
        return `
            <div class="course-card">
                <h3>${course.title}</h3>
                <p>Instructor: ${course.instructor || 'Unknown'}</p>
                <p>Progress: ${e.progress || 0}%</p>
                <a href="course-details.html?id=${course.id}" class="btn-primary">Continue Course</a>
            </div>
        `;
    }).join('');
}

loadMyCourses();
</script>
</body>
</html>
